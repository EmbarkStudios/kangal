{{- range $key, $value := .Values }}
{{- if or (eq $key "proxy") (eq $key "openapi-ui") (eq $key "controller")}}
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: {{ template "<CHARTNAME>.fullname" $ }}-{{ $key }}
  labels:
    app: {{ template "<CHARTNAME>.name" $ }}-{{ $key }}
    chart: {{ template "<CHARTNAME>.chart" $ }}
    release: {{ $.Release.Name }}
    heritage: {{ $.Release.Service }}
  {{- if ($value.serviceAccountAnnotations) }}
  annotations:
    {{- with $value.serviceAccountAnnotations }}
      {{- toYaml . | nindent 4 }}
    {{- end }}
  {{- end }}
{{- end }}
{{- end }}
